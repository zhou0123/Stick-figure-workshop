作品概述
创意来源和产生背景：
因为语义分割的 AI 应用，因为语义图十分简单，所以我们想通过对语义图进行
加工，生成现实的风景图片，或者艺术图片，这样用户只需简单的操作，就能绘
画出很好的作品
作品的用户群体：
本作品可面向所有人
主要功能和特色：
用户通过在绘制界面的左侧绘制简单的图画，然后右侧自动生成现实或艺术的风
景图
应用价值和前景：
户可以通过简单的绘画，就得到美丽的图片，使热爱绘画的作者更快的体会到绘
画的乐趣，同时也可以使热爱绘画但绘画能力不强的人，体会作为一名“绘画大
师”快乐，本作品从普通人的日常生活出发，为用户更好的体会到绘画的快乐
可以给用户提供一种创造的快乐和成就感，在这个浮躁的时代，用户可也静下心
来绘制自己的“世界”，找到自己的快乐
问题描述
拟解决的实际问题：
现在人们通过网络放松自己，但过后，终究只是一时的快乐，有时甚至并不快乐，
只是打发空耗时间，而且有些知道绘画是好的放松方式，但绘画能力不强，很难
绘制出优秀作品，很难体会到创造的快乐的用户。
所以我们开发了《简笔画作坊》，可以给用户提供一种创作的快乐，能静下心来，
．2．
绘制现实，艺术风景，即使用户的绘画能力不强，通过对抗生成网络的辅助，也
可以体会到创作的快乐和成就感，用画笔创造自己的“世界”。
作品的功能和性能需求：
功能是将简单的绘制作品加工，生成现实或艺术的图片
性能需求：windows 系统，cpu 的性能强弱决定加工速度的快慢
数据集：
数据格式：jpg 图片和.mat 语义图
数据来源：Shitflow 语义分割数据集 - Heywhale.com，选取其中的 3 种主题
获取方式：网络下载
数据特点：jpg 图片和.mat 语义图
数据规模：coast：360 张
Country:410 张
City：308 张
经过对下载的图片转化（.mat 转成 jpg 图片）：
．3．
技术方案
我们先后阅读 pix2pix，pix2pixHD，和 gaugan 等相关的对抗生成网络论文，选
择其中的优点并且结合自身的实际硬件情况（4g GTX1650）自行设计网络
总体：
基于对抗生成网络，分别设计产生模型和鉴别模型，然后利用已有的真实图片与
产生模型形成对抗，加速生成器的训练
模型介绍：
网络前端后端采用 u-net 的基本结构，中间用 skips 连接
前后两段的中段，选择 resnet 的 residual 模块，减缓梯度消失问题，使网络最
大程度上学习图片中的语义信息
采用对抗的网络结构，为了的到更好的生成器模型，我们又制作了鉴别器，用来
区分生成图片和真实图片，通过两个网络的对抗训练，使生成器模型更好的学习，
优化的更加迅速
对于训练集的图片，我们采用了随机裁剪等图片增强的方法，为了得到鲁棒性较
好的模型，而且可以丰富实验数据
放弃了常规的交叉熵损失函数而采用 lsgan 的最小二乘损失函数，为提高生成图
片的相似性，采用生成图片与目标图片输入到 vgg19 的其中 5 层的 feature map
做损失函数，使网络不仅关注图片的单个像素点，也关注彼此的结构和联系
系统实现
数据来源：Shitflow 语义分割数据集 - Heywhale.com，选取其中的 3 种主题
．4．
数据训练：
1. 对 256*256 数据 resize 到 286*286，然后随机裁剪
2. 将语义图改成 float32，并且归一化
3. 将语义图传入到生成器，得到生成图片，将生成图片与实际图片传入到预训
练好的 vgg19，选取其中的 5 层 feature maps，做 L1 的损失函数的优化，
4. 将生成图片传入到鉴别器中，真实图片模标输出 30*30 的元素为 1 的矩阵，
生成图片目标输出 30*30 的元素为 0 的矩阵，做损失函数，训练鉴别器
5. 训练 1000epoches，生成器：tf.keras.optimizers.Adam(2e-4, beta_1=0.5)
鉴别器：tf.keras.optimizers.Adam(1.5e-4, beta_1=0.5)
改进过程：
因为设备原因，对网络进行了精简。通过消融实验，简化了多余的 residual 个
数，和空间自适应一体化带来的较多参数（可能是因为数据集较少，所以训练效
果不佳）从 1 亿左右的训练参数降到 2 千万个左右
系统部署方法：
Windows 系统即可
我们通过 PyInstaller,将 tensorflow 相关环境抽出，形成独立的 exe 文件。
分析验证
验证数据集的来源：
自己绘制简笔画
测试过程：
自己实际绘制简笔画，观看生成效果
．5．
分析和结论：
通过自己绘制作品，网络产生的图片效果比较好，但因为自己绘画的语义图片有
些地方脱离实际（自己的绘画能力极低），所以会出现模糊等情况。
作品总结
本作品的亮点就是用户可以通过自己的绘制来得到自己想要的风景，放松心情。
工作量：
周承禹：完成对抗网络的设计与实现
王绍宇：基于 QT 完成画板制作和对抗网络与画板的合并
关于测试方面，我认为效果还是不错的，可以生成很多不错的图片，但是毕竟是
基于语义分割图片，语义分割的图片与实际的人画的图片还是有一定的差距（比
如人很难画一条很直的分割线），所以有时的图片比较抽象。
但是因为本身设备的原因（4g GTX1650）无法训练更大的网络，所以效果无法通
过增大网络来得到提升，而且网络上的公开数据集较少，关于风景的语义分割更
少，所以基于数据“喂”网络也很难，关于未来，如果有更多的数据集，硬件设
备进一步提升，应该可以训练出更好的网络，用户体验应该可以得到进一步提升
．6．
参考文献
QT 官方文档
Semantic Image Synthesis with Spatially-Adaptive Normalization 论
